Warning: EasyOCR not available. Text detection will be disabled.
Warning: rembg not available. Background removal will use mask-based method.
✅ 日本語フォント設定完了: DejaVu Sans
🎌 アニメモード: スコア閾値を 0.105 → 0.0735 に調整
🔄 開始: SAMモデル読み込み (RAM: 634.5MB, GPU: 0.0MB)
SAMモデルを読み込み中... (vit_h)
✅ 完了: SAMモデル読み込み (15.26秒, RAM: 776.9MB, GPU: 2509.6MB)
🔄 開始: YOLOモデル読み込み (RAM: 776.9MB, GPU: 2509.6MB)
🎌 アニメモード: より大きなYOLOモデルで検出精度向上を試行します
アニメ用YOLOモデルを試行中... (yolov8x.pt)
✅ アニメ用YOLOモデルを読み込み完了: yolov8x.pt
デバイス: cuda
✅ 完了: YOLOモデル読み込み (0.79秒, RAM: 1039.5MB, GPU: 2509.6MB)
=== システム情報 ===
CPU: 12 コア
RAM: 19.5GB
GPU: NVIDIA GeForce RTX 4070 Ti SUPER
GPU RAM: 16.0GB
====================
🔄 開始: ファイル収集 (RAM: 1039.8MB, GPU: 2509.6MB)
処理対象画像数: 58 (重複除去後)
✅ 完了: ファイル収集 (0.14秒, RAM: 1039.8MB, GPU: 2509.6MB)

進捗: 1/58 - 0001.jpg
🔄 開始: 画像読み込み (RAM: 1039.8MB, GPU: 2509.6MB)
✅ 完了: 画像読み込み (0.10秒, RAM: 1058.8MB, GPU: 2509.6MB)
カラー判定: 最大チャンネル差分=88.496, 閾値=0.01, 結果=カラー
スキップ: カラー画像です - 0001.jpg

進捗: 2/58 - 0002.jpg
🔄 開始: 画像読み込み (RAM: 1042.8MB, GPU: 2509.6MB)
✅ 完了: 画像読み込み (0.01秒, RAM: 1060.2MB, GPU: 2509.6MB)
カラー判定: 最大チャンネル差分=0.192, 閾値=0.01, 結果=カラー
スキップ: カラー画像です - 0002.jpg

進捗: 3/58 - 0003.jpg
🔄 開始: 画像読み込み (RAM: 1043.0MB, GPU: 2509.6MB)
✅ 完了: 画像読み込み (0.13秒, RAM: 1060.3MB, GPU: 2509.6MB)
カラー判定: 最大チャンネル差分=0.000, 閾値=0.01, 結果=グレースケール
🔄 開始: SAMマスク生成 (RAM: 1095.3MB, GPU: 2509.6MB)
SAMでマスクを生成中...
生成されたマスク数: 47
マスク面積統計: 最小=2837, 最大=1972196, 平均=160398
✅ 完了: SAMマスク生成 (34.43秒, RAM: 1937.2MB, GPU: 2541.6MB)
🔄 開始: YOLO人物検出フィルタリング (RAM: 1935.2MB, GPU: 2541.6MB)
YOLOv8で人物検出スコアを計算中...
YOLOv8で47個のマスクを評価開始...
YOLO処理済み: 10/47 (現在のスコア: 0.000)
YOLO処理済み: 20/47 (現在のスコア: 0.066)
YOLO処理済み: 30/47 (現在のスコア: 0.000)
YOLO処理済み: 40/47 (現在のスコア: 0.050)
人物検出スコア >= 0.0735 のマスク数: 6
YOLO検出スコア統計: 最高=0.418, 最低=0.000, 平均=0.037
上位10スコア: ['0.418', '0.192', '0.182', '0.131', '0.122', '0.116', '0.066', '0.053', '0.050', '0.050']
🎌 アニメモード使用中: yolov8x.pt
✅ 完了: YOLO人物検出フィルタリング (1.81秒, RAM: 1942.8MB, GPU: 2805.5MB)
🎯 複数キャラクター検出: 6個 → 複合スコアで最適選択
🎯 複合スコア評価開始 (基準: balanced, 6個のマスク)
   マスク1: 総合=0.433 (面積=0.07, 全身=0.49, 中央=0.67, 接地=0.75, YOLO=0.42)
   マスク2: 総合=0.434 (面積=0.04, 全身=0.58, 中央=0.69, 接地=0.79, YOLO=0.19)
   マスク3: 総合=0.390 (面積=0.09, 全身=0.81, 中央=0.43, 接地=0.37, YOLO=0.18)
   マスク4: 総合=0.518 (面積=0.17, 全身=0.72, 中央=0.64, 接地=0.98, YOLO=0.13)
   マスク5: 総合=0.391 (面積=0.04, 全身=0.39, 中央=0.71, 接地=0.85, YOLO=0.12)
   マスク6: 総合=0.403 (面積=0.14, 全身=0.46, 中央=0.63, 接地=0.73, YOLO=0.12)
✅ 最適マスク選択: 複合スコア 0.518, 品質スコア 0.286
✅ 保存完了: 0003.jpg (品質: 0.286)

進捗: 4/58 - 0004.jpg
🔄 開始: 画像読み込み (RAM: 1806.5MB, GPU: 2805.5MB)
✅ 完了: 画像読み込み (0.09秒, RAM: 1806.5MB, GPU: 2805.5MB)
カラー判定: 最大チャンネル差分=0.000, 閾値=0.01, 結果=グレースケール
🔄 開始: SAMマスク生成 (RAM: 1804.5MB, GPU: 2805.5MB)
SAMでマスクを生成中...
生成されたマスク数: 92
マスク面積統計: 最小=439, 最大=394994, 平均=59933
✅ 完了: SAMマスク生成 (59.93秒, RAM: 1970.0MB, GPU: 2805.5MB)
🔄 開始: YOLO人物検出フィルタリング (RAM: 1970.0MB, GPU: 2805.5MB)
YOLOv8で人物検出スコアを計算中...
YOLOv8で92個のマスクを評価開始...
YOLO処理済み: 10/92 (現在のスコア: 0.312)
YOLO処理済み: 20/92 (現在のスコア: 0.205)
YOLO処理済み: 30/92 (現在のスコア: 0.205)
YOLO処理済み: 40/92 (現在のスコア: 0.030)
YOLO処理済み: 50/92 (現在のスコア: 0.580)
YOLO処理済み: 60/92 (現在のスコア: 0.000)
YOLO処理済み: 70/92 (現在のスコア: 0.062)
YOLO処理済み: 80/92 (現在のスコア: 0.021)
YOLO処理済み: 90/92 (現在のスコア: 0.224)
人物検出スコア >= 0.0735 のマスク数: 44
YOLO検出スコア統計: 最高=0.882, 最低=0.000, 平均=0.146
上位10スコア: ['0.882', '0.860', '0.817', '0.637', '0.580', '0.516', '0.488', '0.462', '0.424', '0.376']
🎌 アニメモード使用中: yolov8x.pt
✅ 完了: YOLO人物検出フィルタリング (1.95秒, RAM: 1911.6MB, GPU: 2805.5MB)
🎯 複数キャラクター検出: 44個 → 複合スコアで最適選択
⚠️ マスク数制限: 44個 → 20個に制限
🎯 複合スコア評価開始 (基準: balanced, 20個のマスク)
   マスク1: 総合=0.430 (面積=0.15, 全身=0.00, 中央=0.73, 接地=1.00, YOLO=0.88)
   マスク2: 総合=0.624 (面積=0.20, 全身=0.78, 中央=0.68, 接地=0.99, YOLO=0.86)
   マスク3: 総合=0.612 (面積=0.21, 全身=0.74, 中央=0.78, 接地=0.85, YOLO=0.82)
   マスク4: 総合=0.432 (面積=0.11, 全身=0.39, 中央=0.73, 接地=0.61, YOLO=0.64)
   マスク5: 総合=0.399 (面積=0.15, 全身=0.36, 中央=0.64, 接地=0.52, YOLO=0.58)
   マスク6: 総合=0.336 (面積=0.11, 全身=0.12, 中央=0.62, 接地=0.64, YOLO=0.52)
   マスク7: 総合=0.471 (面積=0.08, 全身=0.59, 中央=0.66, 接地=0.78, YOLO=0.49)
   マスク8: 総合=0.471 (面積=0.07, 全身=0.64, 中央=0.56, 接地=0.88, YOLO=0.46)
   マスク9: 総合=0.459 (面積=0.13, 全身=0.43, 中央=0.59, 接地=1.00, YOLO=0.42)
   マスク10: 総合=0.399 (面積=0.12, 全身=0.29, 中央=0.67, 接地=0.80, YOLO=0.38)
   マスク11: 総合=0.387 (面積=0.03, 全身=0.43, 中央=0.70, 接地=0.63, YOLO=0.36)
   マスク12: 総合=0.409 (面積=0.06, 全身=0.45, 中央=0.77, 接地=0.61, YOLO=0.34)
   マスク13: 総合=0.426 (面積=0.25, 全身=0.24, 中央=0.69, 接地=0.80, YOLO=0.33)
   マスク14: 総合=0.292 (面積=0.06, 全身=0.00, 中央=0.76, 接地=0.61, YOLO=0.31)
   マスク15: 総合=0.309 (面積=0.04, 全身=0.04, 中央=0.72, 接地=0.75, YOLO=0.31)
   マスク16: 総合=0.538 (面積=0.13, 全身=0.87, 中央=0.61, 接地=0.88, YOLO=0.28)
   マスク17: 総合=0.433 (面積=0.06, 全身=0.54, 中央=0.58, 接地=0.92, YOLO=0.26)
   マスク18: 総合=0.377 (面積=0.27, 全身=0.00, 中央=0.60, 接地=1.00, YOLO=0.26)
   マスク19: 総合=0.457 (面積=0.11, 全身=0.54, 中央=0.57, 接地=0.99, YOLO=0.26)
   マスク20: 総合=0.357 (面積=0.13, 全身=0.09, 中央=0.73, 接地=0.84, YOLO=0.24)
✅ 最適マスク選択: 複合スコア 0.624, 品質スコア 0.765
✅ 保存完了: 0004.jpg (品質: 0.765)

進捗: 5/58 - 0005.jpg
🔄 開始: 画像読み込み (RAM: 1807.1MB, GPU: 2805.5MB)
✅ 完了: 画像読み込み (0.07秒, RAM: 1807.1MB, GPU: 2805.5MB)
カラー判定: 最大チャンネル差分=0.000, 閾値=0.01, 結果=グレースケール
🔄 開始: SAMマスク生成 (RAM: 1807.1MB, GPU: 2805.5MB)
SAMでマスクを生成中...
生成されたマスク数: 82
マスク面積統計: 最小=902, 最大=1059255, 平均=74802
✅ 完了: SAMマスク生成 (22.81秒, RAM: 1943.3MB, GPU: 2805.5MB)
🔄 開始: YOLO人物検出フィルタリング (RAM: 1943.3MB, GPU: 2805.5MB)
YOLOv8で人物検出スコアを計算中...
YOLOv8で82個のマスクを評価開始...
